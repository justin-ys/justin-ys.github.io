(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{192:(e,t,n)=>{"use strict";n.d(t,{default:()=>o});var l=n(5155),r=n(6366),c=n.n(r),s=n(2115),i=function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.INSERT=1]="INSERT",e}(i||{});function a(e){let[t,n]=(0,s.useState)([{content:""}]),r=(0,s.useRef)([]),a=(0,s.useRef)(null),o=(0,s.useRef)(null),[u,h]=(0,s.useState)(!0),[f,m]=(0,s.useState)(20),d=(0,s.useRef)(null),[x,v]=(0,s.useState)(0),[g,p]=(0,s.useState)(0),[S,T]=(0,s.useState)(0);(0,s.useMemo)(()=>{t.length>20?h(!1):m(20-t.length)},[t.length]);let k=e=>{setTimeout(()=>{r.current[e]&&(r.current[e].style.height="auto",r.current[e].style.height=r.current[e].scrollHeight+"px")},0)},w=(0,s.useCallback)(()=>{if(p(x),r.current[x]){var e;T(null==(e=r.current[x])?void 0:e.selectionStart)}},[x]);(0,s.useMemo)(()=>{t.forEach((e,t)=>k(t)),e.terminalState==i.INSERT?setTimeout(()=>{var e,t;null==(e=r.current[g])||e.focus(),null==(t=r.current[g])||t.setSelectionRange(S,S)}):w()},[e.terminalState]),(0,s.useEffect)(()=>{e.terminalState==i.DEFAULT&&a.current&&a.current.click()});let E=(e,t)=>{n(n=>[...n.slice(0,e+1),t,...n.slice(e+1)]),setTimeout(()=>{let t=r.current[e+1];t&&(t.style.height=t.scrollHeight+"px")},0)};return(0,s.useEffect)(()=>{if(e.prefill){n([]);let l=e.prefill.split("\n"),r=t.length;l.forEach((e,t)=>{e.startsWith("[center]")?E(r+t,{content:e.slice(8),center:!0}):E(r+t,{content:e})})}},[]),(0,l.jsxs)("div",{children:[e.title&&(0,l.jsx)("div",{className:"bg-teal-50",children:(0,l.jsx)("div",{className:"text-center text-black font-mono ".concat(c().terminalText),children:e.title})}),(0,l.jsxs)("div",{ref:a,className:"w-full h-full flex flex-col overflow-y-auto min-h-0",style:{minHeight:0,height:"100%"},tabIndex:0,onKeyDown:n=>{e.terminalState!==i.INSERT&&(n.preventDefault(),"ArrowLeft"===n.key?T(e=>Math.max(0,e-1)):"ArrowRight"===n.key?T(e=>Math.min(t[g].content.length,e+1)):"ArrowUp"===n.key?g>0&&(p(g-1),T(Math.min(S,t[g-1].content.length))):"ArrowDown"===n.key&&g<t.length-1&&(p(g+1),T(Math.min(S,t[g+1].content.length))))},children:[t.map((s,a)=>(0,l.jsxs)("div",{ref:0===a?o:void 0,className:"flex flex-row gap-2 ".concat(c().terminalText),children:[(0,l.jsx)("div",{className:"text-right w-6",children:"".concat(a)}),e.terminalState===i.INSERT?(0,l.jsx)("textarea",{rows:1,value:s.content,ref:e=>{r.current[a]=e},onChange:e=>((e,l)=>{let r=[...t];r[e]={...r[e],content:l.target.value},n(r),k(e)})(a,e),onKeyDown:e=>((e,l)=>{var c,s,i,a,o;if("Enter"===e.key){if(e.preventDefault(),0==t[l].content.length)E(l,{content:""});else if(r.current[l]){let e=t[l].content.slice(0,r.current[l].selectionStart),c=t[l].content.slice(r.current[l].selectionStart),s=t[l];s.content=e,n(e=>[...e.slice(0,l),s,{content:c},...e.slice(l+1)])}setTimeout(()=>{var e;null==(e=r.current[l+1])||e.focus()},0),null==(c=r.current[l+1])||c.setSelectionRange(0,0)}if("Backspace"==e.key){if(0==t[l].content.length&&l>0)0==t[l].content.length&&l>0&&n(e=>[...e.slice(0,l),...e.slice(l+1)]),setTimeout(()=>{var e;null==(e=r.current[l-1])||e.focus()},0);else if((null==(s=r.current[l])?void 0:s.selectionStart)==0&&(null==(i=r.current[l])?void 0:i.selectionEnd)==0&&l>0){let e=t[l-1].content+t[l].content,c=t[l-1];c.content=e,n(e=>[...e.slice(0,l-1),c,...e.slice(l+1)]),setTimeout(()=>{var e;null==(e=r.current[l-1])||e.focus()},0)}}if("ArrowUp"==e.key&&(e.preventDefault(),l>0)){let e=null==(a=r.current[l])?void 0:a.selectionStart;null!=e&&setTimeout(()=>{var t,n;null==(t=r.current[l-1])||t.focus(),null==(n=r.current[l-1])||n.setSelectionRange(e,e)},0)}if("ArrowDown"==e.key&&(e.preventDefault(),l<t.length-1)){let e=null==(o=r.current[l])?void 0:o.selectionStart;null!=e&&setTimeout(()=>{var t,n;null==(t=r.current[l+1])||t.focus(),null==(n=r.current[l+1])||n.setSelectionRange(e,e)},0)}setTimeout(()=>{r.current[l]&&(r.current[l].style.height="auto",r.current[l].style.height=r.current[l].scrollHeight+"px")},0)})(e,a),onFocus:e=>{v(a)},className:"block w-full font-mono text-base bg-transparent outline-none border-none mb-1 ".concat(t[a].center?"text-center":""),spellCheck:!1}):(0,l.jsx)("div",{className:"relative block w-full font-mono text-base bg-transparent outline-none border-none mb-1 whitespace-pre-wrap ".concat(t[a].center?"text-center":""),style:{minHeight:"1.5em",cursor:"default"},children:(()=>{if(g!==a)return s.content;{let e=s.content.split("");return S>=e.length?(0,l.jsxs)("div",{children:[e.join(""),(0,l.jsx)("span",{className:"bg-white text-black inline leading-none p-0 m-0",children:"\xa0"})]}):e.map((e,t)=>t===S?(0,l.jsx)("span",{className:"bg-white text-black inline leading-none p-0 m-0",children:e},t):e)}})()})]},a)),u&&(0,l.jsx)("div",{className:"flex flex-col flex-grow select-none","aria-hidden":"true",children:Array.from({length:f},(e,t)=>(0,l.jsx)("div",{ref:0===t?d:null,className:"text-right w-6 mb-1 block font-mono",children:"~"},t))})]})]})}function o(e){let[t,n]=(0,s.useState)(i.DEFAULT),r=(0,s.useCallback)(e=>{"i"==e.key&&t==i.DEFAULT&&n(i.INSERT),"Escape"==e.key&&t==i.INSERT&&n(i.DEFAULT)},[t]);return(0,s.useEffect)(()=>(document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)),[t]),(0,l.jsxs)("div",{className:"flex-col",children:[(0,l.jsx)("div",{className:"h-[95vh] max-h-[95vh]",children:(0,l.jsx)(a,{title:"File: welcome.vtxt",prefill:e.data,terminalState:t})}),(0,l.jsx)("div",{className:"h-[5vh] flex items-end font-mono ".concat(c().terminalText),children:t==i.INSERT?"-- INSERT --":""})]})}},6321:(e,t,n)=>{Promise.resolve().then(n.bind(n,192))},6366:e=>{e.exports={terminalText:"vimulator_terminalText__3kg9i"}}},e=>{e.O(0,[173,441,255,358],()=>e(e.s=6321)),_N_E=e.O()}]);